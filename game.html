<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>3D Maze Master v2.0</title>
    <style>
        body { margin: 0; background: #000; color: #0f0; font-family: 'Segoe UI', sans-serif; overflow: hidden; }
        #ui { 
            position: absolute; top: 20px; left: 20px; 
            background: rgba(0,0,0,0.85); padding: 15px; 
            border: 2px solid #0f0; border-radius: 10px; 
            pointer-events: none; z-index: 10; 
        }
        #crosshair { 
            position: absolute; top: 50%; left: 50%; 
            width: 15px; height: 15px; border: 2px solid #0f0; 
            border-radius: 50%; transform: translate(-50%, -50%); 
            z-index: 5; pointer-events: none;
        }
        #win-screen { 
            display: none; position: absolute; top: 50%; left: 50%; 
            transform: translate(-50%, -50%); text-align: center;
            background: rgba(0,0,0,0.95); padding: 40px; 
            border: 5px solid gold; border-radius: 30px; z-index: 100; 
        }
        .gold-text { color: gold; font-size: 3.5em; font-weight: bold; text-shadow: 0 0 20px gold; margin: 0; }
        #final-time { color: white; font-size: 1.5em; margin: 20px 0; }
        button { background: gold; border: none; padding: 12px 25px; font-weight: bold; cursor: pointer; border-radius: 8px; font-size: 1em; }
        button:hover { background: #fff; transform: scale(1.1); }
    </style>
</head>
<body>

    <div id="ui">
        <b style="font-size: 1.3em; color: #0f0;">üïπÔ∏è MAZE RUNNER</b><br><br>
        TIME: <span id="timer" style="color:white; font-family: monospace;">0.0</span>s<br>
        MOVE: <span style="color:white">W, S</span> | TURN: <span style="color:white">A, D</span><br>
        GOAL: Find the <span style="color:gold">GOLD WALL</span>
    </div>

    <div id="crosshair"></div>

    <div id="win-screen">
        <h1 class="gold-text">üèÜ VICTORY!</h1>
        <div id="final-time"></div>
        <button onclick="location.reload()">PLAY AGAIN</button>
    </div>

    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        const timerDisplay = document.getElementById("timer");
        const winScreen = document.getElementById("win-screen");
        const finalTimeDisplay = document.getElementById("final-time");

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // 1 = Green Wall, 0 = Path, 2 = Gold Goal
        const map = [
            [1,1,1,1,1,1,1,1,1,1],
            [1,0,0,0,0,0,1,0,0,1],
            [1,0,1,1,1,0,1,0,1,1],
            [1,0,1,0,0,0,0,0,0,1],
            [1,0,1,0,1,1,1,1,0,1],
            [1,0,0,0,1,0,0,0,0,1],
            [1,1,1,0,1,0,1,1,0,1],
            [1,0,0,0,0,0,1,2,0,1],
            [1,1,1,1,1,1,1,1,1,1]
        ];

        const tileSize = 64;
        let player = { x: 96, y: 96, angle: 0 };
        let keys = {};
        let startTime = Date.now();
        let gameActive = true;

        window.addEventListener("keydown", (e) => keys[e.key.toLowerCase()] = true);
        window.addEventListener("keyup", (e) => keys[e.key.toLowerCase()] = false);

        function draw() {
            // Sky & Floor
            ctx.fillStyle = "#111"; ctx.fillRect(0, 0, canvas.width, canvas.height/2);
            ctx.fillStyle = "#222"; ctx.fillRect(0, canvas.height/2, canvas.width, canvas.height/2);

            const fov = Math.PI / 3;
            const rays = canvas.width / 4;

            for (let i = 0; i < rays; i++) {
                let rayAngle = (player.angle - fov/2) + (i / rays) * fov;
                let dist = 0, hit = 0;
                
                while (hit === 0 && dist < 1200) {
                    dist += 1;
                    let tx = Math.floor((player.x + Math.cos(rayAngle) * dist) / tileSize);
                    let ty = Math.floor((player.y + Math.sin(rayAngle) * dist) / tileSize);

                    if (ty < 0 || ty >= map.length || tx < 0 || tx >= map[0].length) {
                        hit = 1;
                    } else if (map[ty][tx] > 0) {
                        hit = map[ty][tx];
                    }
                }

                let fixDist = dist * Math.cos(rayAngle - player.angle);
                let h = (tileSize * canvas.height) / fixDist;
                let shade = Math.max(0, 255 - (fixDist / 4));
                
                if (hit === 2) {
                    ctx.fillStyle = `rgb(${shade}, ${shade*0.8}, 0)`; // Gold Goal
                } else {
                    ctx.fillStyle = `rgb(0, ${shade}, ${shade/3})`; // Green Walls
                }
                ctx.fillRect(i * 4, (canvas.height - h) / 2, 4, h);
            }
        }

        function update() {
            if (!gameActive) return;

            let nextX = player.x, nextY = player.y;
            let moveSpeed = 3.0;
            let rotSpeed = 0.05;

            if (keys['w']) { nextX += Math.cos(player.angle) * moveSpeed; nextY += Math.sin(player.angle) * moveSpeed; }
            if (keys['s']) { nextX -= Math.cos(player.angle) * moveSpeed; nextY -= Math.sin(player.angle) * moveSpeed; }
            if (keys['a']) player.angle -= rotSpeed;
            if (keys['d']) player.angle += rotSpeed;

            let tx = Math.floor(nextX / tileSize), ty = Math.floor(nextY / tileSize);
            
            if (map[ty][tx] === 0) {
                player.x = nextX; player.y = nextY;
            } else if (map[ty][tx] === 2) {
                gameActive = false;
                let totalTime = ((Date.now() - startTime) / 1000).toFixed(2);
                finalTimeDisplay.innerText = "YOUR TIME: " + totalTime + "s";
                winScreen.style.display = "block";
            }

            timerDisplay.innerText = ((Date.now() - startTime) / 1000).toFixed(1);

            draw();
            requestAnimationFrame(update);
        }

        window.onresize = () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; };
        update();
    </script>
</body>
</html>
